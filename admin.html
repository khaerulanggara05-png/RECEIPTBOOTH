<script>
// 1. KEAMANAN: Cek PIN saat masuk
function checkAccess() {
    const pin = prompt("Masukkan PIN Admin:");
    if (pin !== "1234") {
        alert("Akses Ditolak!");
        window.location.href = "index.html";
    }
}
// window.onload = checkAccess; // Hapus // untuk aktifkan

// 2. BARU: SIMPAN NAMA BOOTH & JUDUL
function saveBoothSettings() {
    const name = document.getElementById("adminBoothName").value;
    const subtitle = document.getElementById("adminSubtitle").value;

    if(!name || !subtitle) return alert("Isi Nama Booth dan Subtitle!");

    localStorage.setItem("boothName", name);
    localStorage.setItem("receiptTitle", subtitle);
    
    alert("Nama Booth Diperbarui! ✅");
}

// 3. KONFIGURASI FRAME DINAMIS
function saveFrameConfig() {
    const url = document.getElementById("frameUrlInput").value;
    const target = document.getElementById("layoutTargetInput").value;
    
    if(!url || !target) return alert("Isi URL dan nomor layout!");
    
    localStorage.setItem("customFrameURL_" + target, url);
    alert("Frame Layout " + target + " diperbarui! ✅");
}

// 4. LOG TRANSAKSI
function addLog(type, amount) {
    const logs = JSON.parse(localStorage.getItem("transactionLogs") || "[]");
    const newLog = {
        time: new Date().toLocaleString('id-ID'),
        type: type,
        amount: amount
    };
    logs.push(newLog);
    localStorage.setItem("transactionLogs", JSON.stringify(logs));
    loadLogs();
}

// 5. LOAD DATA SAAT HALAMAN DIBUKA
function loadData() {
    // Muat Nama Booth
    document.getElementById("adminBoothName").value = localStorage.getItem("boothName") || "";
    document.getElementById("adminSubtitle").value = localStorage.getItem("receiptTitle") || "";
    
    // Muat Log
    const logs = JSON.parse(localStorage.getItem("transactionLogs") || "[]");
    const logBox = document.getElementById("logBox");
    if(logBox) {
        if(logs.length === 0) {
            logBox.innerText = "Belum ada transaksi.";
        } else {
            logBox.innerText = logs.map(l => `[${l.time}] ${l.type} - Rp${l.amount}`).reverse().join("\n");
        }
    }
}

window.addEventListener('load', loadData);
</script>
